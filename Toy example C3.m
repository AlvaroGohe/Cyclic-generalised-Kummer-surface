K := GF(7);
A2<x,y> := AffineSpace(K,2);
A3<X, Y, Z> := AffineSpace(K,3);
A5<Xp, Yp, Zp, T, S> := AffineSpace(K,5);
phi1 := map<A2->A3 | [x^3, y^3, x*y]>;
quo1 := Image(phi1);
SingularPoints(quo1);
ADEtype(SingularPoints(quo1)[1]);
phiw := map<A2->A5 | [x, y^2, x^2*y, x*y^3, y^5]>;
quow := Scheme(A5, MinimalBasis(Image(phiw)));

P2<x, y, z> := ProjectiveSpace(K,2);
P3<Z, XY, X3, Y3> := ProjectiveSpace(K,[1, 2, 3, 3]);
phi1 := map <P2->P3 | [z, x*y, x^3, y^3]>;
quo1 := Image(phi1);
Pr3<z3, xyz, xxx, yyy> := ProjectiveSpace(K,3);
phi13 := map<P2->Pr3 | [z^3, x*y*z, x^3, y^3]>;
quo13 := Image(phi13);
pts13 := Points(quo13);
HS1 := HilbertSeries(Ideal(DefiningPolynomials(quo1)));
Ser<t> := PowerSeriesRing(K,18);
Fun<t> := FunctionField(K);
HP2 := HilbertSeries(Ideal(P2));
Ser!HS1;
Ser!(HP2-2/(t^3-1))/3; 
P12<YZ2, X2Z, XY2, XZ5, Y5Z, X5Y> := ProjectiveSpace(K, [1,1,1,2,2,2]);
realphiw := map < P2->P12 | [y*z^2, x^2*z, x*y^2, x*z^5, y^5*z, x^5*y]>;
realquow := Scheme(P12,MinimalBasis(Image(realphiw)));
realquow;
HSw := HilbertSeries(Ideal(DefiningPolynomials(realquow)));
P8<y2z4, x2yz3, xy3z2, x4z2, x3y2z, x2y4, xz5, y5z, x5y> := ProjectiveSpace(K,8);
pi6 := map<realquow->P8 | [YZ2^2, YZ2*X2Z, YZ2*XY2, X2Z^2, X2Z*XY2, XY2^2, XZ5, Y5Z, X5Y]>;
quow6:=Scheme(P8,MinimalBasis(Image(pi6)));
pi6 := map<realquow->quow6 | [YZ2^2, YZ2*X2Z, YZ2*XY2, X2Z^2, X2Z*XY2, XY2^2, XZ5, Y5Z, X5Y]>;
pts := Points(quow6);
//SSquow6 := SingularSubscheme(quow6);
des := iso<quo1->realquow | [XY*Z^2, X3*Z, XY^2, X3*Z^5, XY^2*Y3*Z,X3^2*XY], [X2Z*Y5Z, XY2^5*YZ2, XY2^2*X5Y*X2Z*Y5Z^2, XY2^6*YZ2*Y5Z] >;
// SingularPoints(quow6);
Pullback(des,realquow![0,0,0,0,0,1]);
realquow![0,0,0,0,0,1]; 
quomap := map<quow6->quo13 | [x2yz3, x3y2z, x5y, x2y4]>;
[<Dimension(V), Degree(V)>: V in IrreducibleComponents(Pullback(quomap,SingularPoints(quo13)[1]))]; 
[IsSingular(pt): pt in pts13];
[<IsSingular(pt),[<Dimension(V), Degree(V)>: V in IrreducibleComponents(Pullback(quomap,pt))]>: pt in pts13];
quoyz := map<quow6->quo13 | [y2z4, xy3z2, x3y2z, y5z]>;
quoxz := map<quow6->quo13 | [xz5, x2yz3, x4z2, xy3z2]>;
[<IsSingular(pt),Dimension(Intersection(Pullback(quoxz,pt),Intersection(Pullback(quomap,pt), Pullback(quoyz,pt))))>: pt in pts13];
exclin := [IrreducibleComponents(Intersection(Pullback(quoxz,pt),Intersection(Pullback(quomap,pt), Pullback(quoyz,pt))))[1]: pt in SingularPoints(quo13)]; //These are disjoin, I've checked
[<pt,IsSingular(quow6!pt)>: pt in Points(exclin[1])];
[<pt,IsSingular(quow6!pt)>: pt in Points(exclin[2])];
[<pt,IsSingular(quow6!pt)>: pt in Points(exclin[3])];
ADEtype(quow6![0,0,0,0,0,0,0,0,1]);
ADEtype(quow6![0,0,0,0,0,0,0,1,0]);
ADEtype(quow6![0,0,0,0,0,0,1,0,0]);
Intersection(Intersection(BaseScheme(quomap),BaseScheme(quoyz)),BaseScheme(quoxz));

P12<XZ2, Y2Z, YX2, YZ5, X5Z, Y5X> := ProjectiveSpace(K, [1,1,1,2,2,2]);
realphiv := map < P2->P12 | [x*z^2, y^2*z, y*x^2, y*z^5, x^5*z, y^5*x]>;
realquov := Scheme(P12,MinimalBasis(Image(realphiv)));
realquov;
P8<x2z4, y2xz3, yx3z2, y4z2, y3x2z, y2x4, yz5, x5z, y5x> := ProjectiveSpace(K,8);
pi6 := map<realquov->P8 | [XZ2^2, XZ2*Y2Z, XZ2*YX2, Y2Z^2, Y2Z*YX2, YX2^2, YZ5, X5Z, Y5X]>;
quov6:=Scheme(P8,MinimalBasis(Image(pi6)));
pi6 := map<realquov->quov6 | [XZ2^2, XZ2*Y2Z, XZ2*YX2, Y2Z^2, Y2Z*YX2, YX2^2, YZ5, X5Z, Y5X]>;
ptsv := Points(quov6);
